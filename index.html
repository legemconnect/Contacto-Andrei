<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Andrei Dima | Perfil Legal & Tech</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Perfil profesional de Andrei Dima. Derecho & IA.">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&family=Space+Grotesk:wght@500;700&display=swap" rel="stylesheet">
    
    <script src="https://code.highcharts.com/maps/highmaps.js"></script>
    <script src="https://code.highcharts.com/mapdata/custom/europe.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js"></script>

    <style>
        /* --- 1. VARIABLES & RESET (SISTEMA DE TEMAS) --- */
        :root {
            /* TEMA OSCURO (POR DEFECTO) */
            --bg-deep: #0f172a;       /* Fondo principal oscuro */
            --bg-card: #1e293b;       /* Fondo tarjetas */
            --bg-element: #28364a;    /* Fondo botones/inputs */
            --accent-primary: #38bdf8; /* Azul cyan */
            --text-main: #f1f5f9;     /* Texto blanco */
            --text-muted: #94a3b8;    /* Texto gris */
            --border-color: #334155;  /* Bordes */
            --radius-lg: 24px;
            --radius-sm: 12px;
            --font-main: 'Inter', sans-serif;
            --font-display: 'Space Grotesk', sans-serif;
            
            /* Colores espec√≠ficos del Mapa (Oscuro) */
            --map-null: #334155;      
            --map-border: #1e293b;
            --map-hover: #38bdf8;
        }

        /* TEMA CLARO (OFFICE MODE) */
        body.light-mode {
            --bg-deep: #f8fafc;       /* Blanco gris√°ceo */
            --bg-card: #ffffff;       /* Blanco puro */
            --bg-element: #f1f5f9;    /* Gris muy claro */
            --accent-primary: #0ea5e9; /* Azul m√°s s√≥lido */
            --text-main: #1e293b;     /* Texto oscuro */
            --text-muted: #64748b;    /* Gris medio */
            --border-color: #cbd5e1;  /* Bordes suaves */
            
            /* Colores espec√≠ficos del Mapa (Claro) */
            --map-null: #e2e8f0;      
            --map-border: #94a3b8;
            --map-hover: #0ea5e9;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }

        body {
            background-color: var(--bg-deep);
            color: var(--text-main);
            font-family: var(--font-main);
            line-height: 1.6;
            min-height: 100vh;
            overflow-x: hidden;
            transition: background-color 0.3s ease, color 0.3s ease;
            opacity: 1;
        }

        body.fading { opacity: 0.8; }

        /* --- 2. LAYOUT --- */
        .main-wrapper {
            max-width: 1100px;
            margin: 0 auto;
            padding: 40px 20px;
            display: grid;
            grid-template-columns: 320px 1fr; 
            gap: 30px;
            align-items: start;
        }

        /* --- 3. SIDEBAR --- */
        .sidebar {
            background-color: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-lg);
            padding: 30px;
            text-align: center;
            position: sticky;
            top: 30px;
            display: flex;
            flex-direction: column;
            gap: 20px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            z-index: 10;
            transition: background-color 0.3s ease, border-color 0.3s ease;
        }

        .profile-img-wrapper {
            width: 140px;
            height: 140px;
            margin: 0 auto;
            border-radius: 20px; 
            padding: 6px;
            background: var(--accent-primary); 
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .profile-img-wrapper img {
            width: 100%;
            height: 100%; object-fit: contain;
            border-radius: 14px; background: #fff; border: 3px solid var(--bg-card);
            transition: border-color 0.3s ease;
        }

        .sidebar h3 {
            font-family: var(--font-display);
            font-size: 1.6rem; margin-bottom: 5px; color: var(--text-main);
        }

        .tagline {
            font-size: 0.85rem;
            color: var(--accent-primary); text-transform: uppercase;
            letter-spacing: 1.5px; font-weight: 700; margin-bottom: 5px;
        }

        .social-links { display: flex; justify-content: center; gap: 15px; }
        .social-links a {
            width: 42px;
            height: 42px; display: flex; align-items: center; justify-content: center;
            border-radius: 50%; background: var(--bg-element); color: var(--text-main);
            transition: all 0.2s; text-decoration: none;
            font-size: 1.2rem; border: 1px solid var(--border-color);
        }
        .social-links a:hover {
            background: var(--accent-primary);
            color: #fff; transform: translateY(-2px); border-color: var(--accent-primary);
        }

        /* --- 4. CONTENT AREA --- */
        .content-area { display: flex; flex-direction: column; gap: 30px; }

        .section-header {
            display: flex;
            align-items: center; gap: 12px; margin-bottom: 20px;
            border-bottom: 1px solid var(--border-color); padding-bottom: 10px;
        }
        .section-header i { color: var(--accent-primary); font-size: 1.2rem; }
        .section-header h3 { font-family: var(--font-display); font-size: 1.4rem; margin: 0; }

        .clean-card {
            background-color: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-sm); padding: 25px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
            transition: background-color 0.3s ease, border-color 0.3s ease;
        }

        ul { list-style: none; padding: 0; display: grid; gap: 12px; }
        .link-card {
            display: flex;
            align-items: center; padding: 15px;
            background-color: var(--bg-element); 
            border: 1px solid var(--border-color);
            border-radius: 8px;
            text-decoration: none; color: var(--text-main);
            transition: all 0.2s; font-weight: 500;
        }
        .link-card:hover {
            background-color: var(--bg-card);
            transform: translateX(5px); color: var(--accent-primary);
            border-color: var(--accent-primary);
        }
        .link-card i { margin-right: 15px; color: var(--accent-primary); width: 20px; text-align: center; }

        /* Quiz */
        .andi-quiz-term strong {
            display: block;
            font-size: 2rem; font-family: var(--font-display);
            color: var(--text-main); margin: 10px 0;
            transition: color 0.3s;
        }
        .andi-quiz-answer {
            background: #064e3b;
            color: #6ee7b7; padding: 10px;
            border-radius: 8px; margin: 20px 0; display: none; font-weight: bold;
        }
        .andi-quiz-answer.visible { display: block; animation: fadeIn 0.3s; }
        .andi-quiz-controls button {
            padding: 10px 20px;
            border-radius: 6px; border: none;
            font-weight: 600; cursor: pointer; transition: 0.2s;
        }
        #andi-btn-reveal { background: var(--accent-primary); color: #fff; }
        
        /* Mapa */
        .map-toggle {
            width: 100%;
            padding: 15px; background: var(--bg-element); color: var(--text-main);
            border: 1px solid var(--border-color); border-radius: 8px; cursor: pointer;
            display: flex; justify-content: space-between; align-items: center;
            transition: background-color 0.3s ease;
        }
        .map-toggle:hover { background-color: var(--bg-card); border-color: var(--accent-primary); }

        .map-content {
            max-height: 0;
            overflow: hidden; transition: max-height 0.5s ease; opacity: 0;
        }
        .map-content.expanded { max-height: 600px; opacity: 1; margin-top: 20px; }
        #map-container { height: 500px; width: 100%; border-radius: 8px; background: var(--bg-element); transition: background-color 0.3s ease;}

        /* --- ESTILOS TOOLTIP --- */
        .custom-tooltip {
            padding: 12px;
            text-align: center; color: #333;
            width: 300px; 
            transition: width 0.3s ease;
        }
        .custom-tooltip.wide { width: 480px; }
        .tooltip-gallery {
            display: grid;
            grid-template-columns: 1fr; gap: 6px; margin-bottom: 8px;
        }
        .custom-tooltip.wide .tooltip-gallery { grid-template-columns: 1fr 1fr; }
        .tooltip-gallery img {
            width: 100%;
            height: 180px; 
            object-fit: cover;
            border-radius: 6px; background-color: #ddd;
        }

        /* Formulario */
        form label { font-size: 0.9rem; color: var(--text-muted); margin-top: 15px; display: block; }
        input, textarea {
            width: 100%;
            padding: 12px; margin-top: 5px;
            background: var(--bg-deep);
            border: 1px solid var(--border-color);
            border-radius: 6px; color: var(--text-main); font-family: inherit;
            transition: border-color 0.2s;
        }
        input:focus, textarea:focus { outline:none; border-color: var(--accent-primary); }

        button[type="submit"] {
            width: 100%;
            padding: 14px; margin-top: 25px;
            background: var(--accent-primary); color: #fff;
            border: none; font-weight: 700; border-radius: 6px; cursor: pointer;
            transition: all 0.3s ease;
        }
        button[type="submit"].loading {
            background: var(--text-muted);
            color: var(--bg-deep); cursor: not-allowed;
        }

        /* CONTROLES */
        .controls-wrapper {
            margin-bottom: 20px; display: flex; justify-content: center; gap: 10px; flex-wrap: wrap;
        }
        .control-btn {
            background: transparent;
            border: 1px solid var(--border-color);
            color: var(--text-muted); padding: 6px 16px; border-radius: 20px; cursor: pointer;
            font-size: 0.95rem; display: flex; align-items: center; gap: 6px;
            transition: all 0.2s ease;
        }
        .control-btn:hover { border-color: var(--text-muted); color: var(--text-main); }
        .control-btn.active { background: var(--accent-primary); color: #fff; border-color: var(--accent-primary); font-weight: bold; }
        
        #theme-toggle i { font-size: 1rem; }

        footer { margin-top: 50px; text-align: center; font-size: 0.8rem; color: var(--text-muted); padding-bottom: 20px;}
        .confirmation, .error { 
            padding: 15px;
            border-radius: 6px; margin-top: 15px; display: none; text-align: center; 
            animation: slideIn 0.4s ease-out;
        }
        .confirmation { background: #064e3b; color: #6ee7b7; border: 1px solid #047857; }
        .error { background: #7f1d1d; color: #fca5a5; border: 1px solid #b91c1c; }

        @media (max-width: 850px) {
            .main-wrapper { grid-template-columns: 1fr; gap: 30px; padding: 20px 15px; }
            .sidebar { position: relative; top: 0; padding: 20px; }
            #map-container { height: 400px; }
            .custom-tooltip.wide { width: 300px; } 
            .custom-tooltip.wide .tooltip-gallery { grid-template-columns: 1fr; }
        }
        
        @keyframes fadeIn { from { opacity:0; } to { opacity:1; } }
        @keyframes slideIn { from { opacity:0; transform: translateY(10px); } to { opacity:1; transform: translateY(0); } }
    </style>
</head>
<body>

    <div class="main-wrapper">
        <aside class="sidebar">
            <div class="controls-wrapper">
                <button class="control-btn lang-btn active" data-lang="es">üá™üá∏ ES</button>
                <button class="control-btn lang-btn" data-lang="en">üá¨üáß EN</button>
                <button class="control-btn" id="theme-toggle" title="Cambiar Tema">
                    <i class="fa-solid fa-moon"></i>
                </button>
            </div>

            <div class="profile-img-wrapper">
                <img src="img/Uji.png" alt="Logo UJI" onerror="this.src='https://via.placeholder.com/150/38bdf8/ffffff?text=UJI'">
            </div>
            
            <div class="profile-text">
                <div class="tagline">Law & Tech</div>
                <h3 id="about-title">Andrei Dima</h3>
                <p class="bio-text" id="about-text1" style="color:var(--text-muted); font-size:0.9rem;">Estudiante de Derecho con una profunda pasi√≥n por la tecnolog√≠a, la inteligencia artificial y el asesoramiento jur√≠dico empresarial.</p>
                <p class="bio-text" id="about-text2" style="color:var(--text-muted); font-size:0.85rem;">Este sitio sirve como mi portal profesional, donde puedes encontrar mis publicaciones, trabajos y una forma directa de contactarme.</p>
            </div>

            <div class="social-links">
                <a href="https://www.linkedin.com/in/andidima/" target="_blank" title="LinkedIn"><i class="fa-brands fa-linkedin-in"></i></a>
                <a href="https://github.com/legemconnect/Contacto-Andrei" target="_blank" title="GitHub"><i class="fa-brands fa-github"></i></a>
                <a href="mailto:andreidimaavram@gmail.com" title="Email"><i class="fa-solid fa-envelope"></i></a>
            </div>
        </aside>

        <main class="content-area">
            <section id="mis-informes" class="clean-card">
                <div class="section-header">
                    <i class="fa-solid fa-book-open"></i>
                    <h3 id="reports-title">Trabajos Acad√©micos</h3>
                </div>
                <p id="reports-subtitle" style="color: var(--text-muted); margin-bottom: 20px; font-size: 0.9rem;">Accede a mis trabajos acad√©micos y proyectos.</p>
                <ul>
                    <li>
                        <a href="reports/Fondos NewGen.pdf" target="_blank" class="link-card">
                            <i class="fa-solid fa-earth-europe"></i>
                            <span id="report1">Fondos NewGen UE: An√°lisis Jur√≠dico</span>
                        </a>
                    </li>
                    <li>
                        <a href="reports/Comentario STS.pdf" target="_blank" class="link-card">
                            <i class="fa-solid fa-scale-balanced"></i>
                            <span id="report2">Comentario: Sentencia del Tribunal Supremo (191/2021)</span>
                        </a>
                    </li>
                    <li>
                        <a href="reports/Comentario STS 2.pdf" target="_blank" class="link-card">
                            <i class="fa-solid fa-scale-balanced"></i>
                            <span id="report3">Comentario: Sentencia del Tribunal Supremo (3079/2016)</span>
                        </a>
                    </li>
                    <li>
                        <a href="reports/Jueces Robot.pdf" target="_blank" class="link-card">
                            <i class="fa-solid fa-microchip"></i>
                            <span id="report4">An√°lisis Jur√≠dico de los Jueces Robot</span>
                        </a>
                    </li>
                    <li>
                        <a href="reports/Transporte Maritimo.pdf" target="_blank" class="link-card">
                            <i class="fa-solid fa-ship"></i>
                            <span id="report5">Presentaci√≥n sobre Transporte Mar√≠timo</span>
                        </a>
                    </li>
                    <li>
                        <a href="reports/Responsabilidad Extracontractual.pdf" target="_blank" class="link-card">
                            <i class="fa-solid fa-globe"></i>
                            <span id="report6">An√°lisis Pr√°ctico de Responsabilidad Extracontractual Internacional</span>
                        </a>
                    </li>
                </ul>
            </section>

            <section id="andi-quiz-section" class="clean-card" style="text-align:center;">
                <div class="section-header" style="justify-content: center; border:none; flex-direction: column; gap:5px;">
                    <h3 id="andi-quiz-title"><i class="fa-solid fa-brain" style="color:var(--accent-primary); margin-right:8px;"></i> Quiz Traducci√≥n Jur√≠dica</h3>
                    <p id="quiz-subtitle" style="font-size:0.8rem; color:var(--text-muted); margin:0;">Adivina la traducci√≥n correcta</p>
                </div>
                <div class="andi-quiz-term">
                    <span style="color: var(--text-muted); font-size:0.8rem; text-transform: uppercase;">T√©rmino / Term</span>
                    <strong id="andi-quiz-term-text">Abogado</strong>
                </div>
                <div class="andi-quiz-answer" id="andi-quiz-answer">Lawyer</div>
                <div class="andi-quiz-controls">
                    <button id="andi-btn-reveal" type="button">Revelar</button>
                    <button id="andi-btn-next" class="secondary" type="button" style="background:transparent; border:1px solid var(--border-color); color:var(--text-main); margin-left:10px;">Siguiente</button>
                </div>
            </section>

            <section id="mis-viajes">
                <div class="section-header">
                    <i class="fa-solid fa-earth-americas"></i>
                    <h3 id="travel-title">Mis Viajes</h3>
                </div>
                <button class="map-toggle" id="mapToggle">
                    <span id="map-toggle-text">Desplegar Mapa Interactivo</span>
                    <i class="fa-solid fa-chevron-down"></i>
                </button>
                <div class="map-content" id="mapContent">
                    <div id="map-container"></div>
                </div>
            </section>
            
            <section id="formulario-contacto" class="clean-card">
                <div class="section-header">
                    <i class="fa-solid fa-gavel"></i>
                    <h3 id="contact-title">Consulta Legal</h3>
                </div>
                <p id="contact-subtitle" style="color: var(--text-muted); font-size: 0.9rem;">Formulario para revisi√≥n preliminar.</p>
                <form id="legal-form">
                    <label for="name" id="label-name">Nombre:</label>
                    <input type="text" id="name" name="name" required>
                    <label for="email" id="label-email">Correo electr√≥nico:</label>
                    <input type="email" id="email" name="email" required>
                    <label for="phone" id="label-phone">Tel√©fono:</label>
                    <input type="tel" id="phone" name="phone" required>
                    <label for="description" id="label-description">Descripci√≥n del problema:</label>
                    <textarea id="description" name="description" required rows="4"></textarea>
                    
                    <label for="jurisdiction" id="label-jurisdiction">Ubicaci√≥n actual (Ciudad, Pa√≠s):</label>
                    <input type="text" id="jurisdiction" name="jurisdiction" placeholder="Ej: Madrid, Espa√±a" required>
                    
                    <button type="submit"><span id="btn-submit">Enviar Consulta</span></button>
                </form>
                <div id="confirmation" class="confirmation"><span id="confirmation-text">¬°Enviado correctamente!</span></div>
                <div id="error" class="error"><span id="error-text">Error al enviar.</span></div>
                <div id="response" style="display:none; margin-top: 20px; background: var(--bg-element); padding: 15px; border-radius: 6px; border-left: 3px solid var(--accent-primary);"></div>
            </section>

            <footer>
                <p><strong id="disclaimer-title" style="color: #fca5a5;">Descargo de responsabilidad:</strong> <span id="disclaimer-text">La informaci√≥n proporcionada en este sitio es solo para fines acad√©micos y no constituye asesoramiento legal. Consulte siempre con un abogado calificado para problemas legales espec√≠ficos.</span></p>
                <p id="footer-contact">Contacto: andreidimaavram@gmail.com</p>
            </footer>
        </main>
    </div>

    <script>
        /* ================= DATOS MAPA (TEXTOS ACTUALIZADOS) ================= */
        const visitedCountriesData = [
            { code: 'es', name: {es: 'Espa√±a', en: 'Spain'}, text: {es: 'Mi hogar y base de mi educaci√≥n.', en: 'My home and the base of my education.'}, imgs: ['img/paises/espana_1.jpg','img/paises/espana_2.jpg','img/paises/espana_3.jpg','img/paises/espana_4.jpg'] },
            { code: 'fr', name: {es: 'Francia', en: 'France'}, text: {es: 'Viaje a Francia, Lyon y Marsella.', en: 'Trip to France, Lyon and Marseille.'}, imgs: ['img/paises/francia_1.jpg'] },
            { code: 'ie', name: {es: 'Irlanda', en: 'Ireland'}, text: {es: 'Experiencia inolvidable en Dubl√≠n.', en: 'Unforgettable experience in Dublin.'}, imgs: ['img/paises/irlanda_1.jpg','img/paises/irlanda_2.jpg','img/paises/irlanda_3.jpg'] },
            { code: 'ch', name: {es: 'Suiza', en: 'Switzerland'}, text: {es: 'El pa√≠s de la diplomacia internacional.', en: 'The country of international diplomacy.'}, imgs: ['img/paises/suiza_1.jpg'] },
            { code: 'it', name: {es: 'Italia', en: 'Italy'}, text: {es: 'Arte, historia y gastronom√≠a inigualable.', en: 'Art, history, and unrivaled cuisine.'}, imgs: ['img/paises/italia_1.jpg'] },
            { code: 'de', name: {es: 'Alemania', en: 'Germany'}, text: {es: 'Coraz√≥n de Europa: Historia y Modernidad.', en: 'Heart of Europe: History and Modernity.'}, imgs: ['img/paises/alemania_1.jpg'] },
            { code: 'at', name: {es: 'Austria', en: 'Austria'}, text: {es: 'Viena: Arte, m√∫sica y palacios imperiales.', en: 'Vienna: Art, music, and imperial palaces.'}, imgs: ['img/paises/austria_1.jpg','img/paises/austria_2.jpg'] },
            { code: 'cz', name: {es: 'Rep. Checa', en: 'Czech Rep.'}, text: {es: 'Brno: mi segunda casa.', en: 'Brno: my second home.'}, imgs: ['img/paises/chequia_1.jpg','img/paises/chequia_2.jpg','img/paises/chequia_3.jpg','img/paises/chequia_4.jpg'] },
            { code: 'si', name: {es: 'Eslovenia', en: 'Slovenia'}, text: {es: 'Joyas ocultas y naturaleza verde.', en: 'Hidden gems and green nature.'}, imgs: ['img/paises/eslovenia_1.jpg'] },
            { code: 'hu', name: {es: 'Hungr√≠a', en: 'Hungary'}, text: {es: 'Budapest: La perla del Danubio.', en: 'Budapest: Pearl of the Danube.'}, imgs: ['img/paises/hungria_1.jpg'] },
            { code: 'ro', name: {es: 'Ruman√≠a', en: 'Romania'}, text: {es: 'Mis ra√≠ces y familia.', en: 'My roots and family.'}, imgs: ['img/paises/rumania_1.jpg'] },
            { code: 'ad', name: {es: 'Andorra', en: 'Andorra'}, text: {es: 'Nieve, monta√±as y paisajes √∫nicos.', en: 'Snow, mountains, and unique landscapes.'}, imgs: [] },
            { code: 'mc', name: {es: 'M√≥naco', en: 'Monaco'}, text: {es: 'Lujo y belleza en la Costa Azul.', en: 'Luxury and beauty on the French Riviera.'}, imgs: [] }
        ];

        /* ================= TRADUCCIONES ================= */
        const translations = {
            es: {
                'about-title': 'Andrei Dima', 
                'about-text1': 'Estudiante de Derecho con una profunda pasi√≥n por la tecnolog√≠a, la inteligencia artificial y el asesoramiento jur√≠dico empresarial.',
                'about-text2': 'Este sitio sirve como mi portal profesional, donde puedes encontrar mis publicaciones, trabajos y una forma directa de contactarme.',
                'reports-title': 'Trabajos Acad√©micos', 
                'reports-subtitle': 'Accede a mis trabajos acad√©micos y proyectos.', 
                'report1': 'Fondos NewGen UE: An√°lisis Jur√≠dico', 
                'report2': 'Comentario: Sentencia del Tribunal Supremo (191/2021)', 
                'report3': 'Comentario: Sentencia del Tribunal Supremo (3079/2016)',
                'report4': 'An√°lisis Jur√≠dico de los Jueces Robot', 
                'report5': 'Presentaci√≥n sobre Transporte Mar√≠timo',
                'report6': 'An√°lisis Pr√°ctico de Responsabilidad Extracontractual Internacional',
                'travel-title': 'Mis Viajes', 'map-show': 'Desplegar Mapa', 'map-hide': 'Ocultar Mapa', 
                'contact-title': 'Consulta Legal', 'contact-subtitle': 'Formulario para revisi√≥n preliminar.', 'label-name': 'Nombre:', 'label-email': 'Correo electr√≥nico:', 'label-phone': 'Tel√©fono:', 'label-description': 'Descripci√≥n del problema:', 
                'label-jurisdiction': 'Ubicaci√≥n actual (Ciudad, Pa√≠s):',
                'btn-submit': 'Enviar Consulta', 'confirmation-text': '¬°Enviado correctamente!', 'error-text': 'Error al enviar.', 
                'response-thanks': 'Gracias por compartir su problema legal.', 
                'response-general': 'Este servicio proporciona orientaci√≥n general y no sustituye el asesoramiento profesional.', 
                'response-resources': 'Puede consultar estos recursos:', 
                'disclaimer-title': 'Descargo de responsabilidad:', 
                'disclaimer-text': 'La informaci√≥n proporcionada en este sitio es solo para fines acad√©micos y no constituye asesoramiento legal. Consulte siempre con un abogado calificado para problemas legales espec√≠ficos.', 
                'andi-quiz-title': 'Quiz Traducci√≥n Jur√≠dica', 
                'quiz-subtitle': 'Adivina la traducci√≥n correcta', 'quiz-reveal': 'Revelar', 'quiz-hide': 'Ocultar', 'quiz-next': 'Siguiente'
            },
            en: {
                'about-title': 'Andrei Dima', 
                'about-text1': 'Law student with a deep passion for technology, artificial intelligence, and corporate legal consulting.',
                'about-text2': 'This site serves as my professional portal, where you can find my publications, work, and a direct way to contact me.',
                'reports-title': 'Academic Papers', 
                'reports-subtitle': 'Access my academic papers and projects.', 
                'report1': 'Analysis of EU NewGen Funds', 
                'report2': 'Commentary: Supreme Court Ruling (191/2021)', 
                'report3': 'Commentary: Supreme Court Ruling (3079/2016)',
                'report4': 'Legal Analysis of Robot Judges', 
                'report5': 'Presentation on Maritime Transport',
                'report6': 'Practical Analysis of International Non-Contractual Liability',
                'travel-title': 'My Travels', 'map-show': 'Show Map', 'map-hide': 'Hide Map', 
                'contact-title': 'Legal Consultation', 'contact-subtitle': 'Preliminary review form.', 'label-name': 'Name:', 'label-email': 'Email:', 'label-phone': 'Phone:', 'label-description': 'Issue Description:', 
                'label-jurisdiction': 'Current Location (City, Country):',
                'btn-submit': 'Submit Inquiry', 'confirmation-text': 'Sent successfully!', 'error-text': 'Error sending.', 
                'response-thanks': 'Thank you for sharing your legal issue.', 
                'response-general': 'This service provides general guidance and does not replace professional advice.', 
                'response-resources': 'You can consult these resources:', 
                'disclaimer-title': 'Disclaimer:', 'disclaimer-text': 'The information provided on this site is for academic purposes only and does not constitute legal advice. Always consult with a qualified attorney for specific legal issues.', 
                'andi-quiz-title': 'Legal Translation Quiz', 
                'quiz-subtitle': 'Guess the correct translation', 'quiz-reveal': 'Reveal', 'quiz-hide': 'Hide', 'quiz-next': 'Next'
            }
        };

        /* ================= QUIZ 50 T√âRMINOS ================= */
        const flashcards = [
            { es:{q:'Abogado', a:'Lawyer'}, en:{q:'Lawyer', a:'Abogado'} },
            { es:{q:'Contrato', a:'Contract'}, en:{q:'Contract', a:'Contrato'} },
            { es:{q:'Jurisdicci√≥n', a:'Jurisdiction'}, en:{q:'Jurisdiction', a:'Jurisdicci√≥n'} },
            { es:{q:'Demandante', a:'Plaintiff'}, en:{q:'Plaintiff', a:'Demandante'} },
            { es:{q:'Demandado', a:'Defendant'}, en:{q:'Defendant', a:'Demandado'} },
            { es:{q:'Demanda', a:'Lawsuit/Claim'}, en:{q:'Lawsuit', a:'Demanda'} },
            { es:{q:'Veredicto', a:'Verdict'}, en:{q:'Verdict', a:'Veredicto'} },
            { es:{q:'Juez', a:'Judge'}, en:{q:'Judge', a:'Juez'} },
            { es:{q:'Tribunal', a:'Court'}, en:{q:'Court', a:'Tribunal'} },
            { es:{q:'Fiscal', a:'Prosecutor'}, en:{q:'Prosecutor', a:'Fiscal'} },
            { es:{q:'Propiedad Intelectual', a:'IP'}, en:{q:'IP', a:'Propiedad Intelectual'} },
            { es:{q:'Testigo', a:'Witness'}, en:{q:'Witness', a:'Testigo'} },
            { es:{q:'Juramento', a:'Oath'}, en:{q:'Oath', a:'Juramento'} },
            { es:{q:'Fianza', a:'Bail'}, en:{q:'Bail', a:'Fianza'} },
            { es:{q:'Delito grave', a:'Felony'}, en:{q:'Felony', a:'Delito grave'} },
            { es:{q:'Delito leve', a:'Misdemeanor'}, en:{q:'Misdemeanor', a:'Delito leve'} },
            { es:{q:'Apelaci√≥n', a:'Appeal'}, en:{q:'Appeal', a:'Apelaci√≥n'} },
            { es:{q:'Sentencia', a:'Sentence/Judgment'}, en:{q:'Judgment', a:'Sentencia'} },
            { es:{q:'Custodia', a:'Custody'}, en:{q:'Custody', a:'Custodia'} },
            { es:{q:'Negligencia', a:'Negligence'}, en:{q:'Negligence', a:'Negligencia'} },
            { es:{q:'Da√±os y perjuicios', a:'Damages'}, en:{q:'Damages', a:'Da√±os y perjuicios'} },
            { es:{q:'Orden judicial', a:'Warrant/Order'}, en:{q:'Warrant', a:'Orden judicial'} },
            { es:{q:'Patente', a:'Patent'}, en:{q:'Patent', a:'Patente'} },
            { es:{q:'Marca registrada', a:'Trademark'}, en:{q:'Trademark', a:'Marca registrada'} },
            { es:{q:'Derechos de autor', a:'Copyright'}, en:{q:'Copyright', a:'Derechos de autor'} },
            { es:{q:'Acuerdo', a:'Settlement'}, en:{q:'Settlement', a:'Acuerdo'} },
            { es:{q:'Responsabilidad', a:'Liability'}, en:{q:'Liability', a:'Responsabilidad'} },
            { es:{q:'Cl√°usula', a:'Clause'}, en:{q:'Clause', a:'Cl√°usula'} },
            { es:{q:'Incumplimiento', a:'Breach'}, en:{q:'Breach', a:'Incumplimiento'} },
            { es:{q:'Testamento', a:'Will'}, en:{q:'Will', a:'Testamento'} },
            { es:{q:'Herencia', a:'Inheritance'}, en:{q:'Inheritance', a:'Herencia'} },
            { es:{q:'Arrendamiento', a:'Lease'}, en:{q:'Lease', a:'Arrendamiento'} },
            { es:{q:'Inquilino', a:'Tenant'}, en:{q:'Tenant', a:'Inquilino'} },
            { es:{q:'Desahucio', a:'Eviction'}, en:{q:'Eviction', a:'Desahucio'} },
            { es:{q:'Quiebra', a:'Bankruptcy'}, en:{q:'Bankruptcy', a:'Quiebra'} },
            { es:{q:'Fusi√≥n', a:'Merger'}, en:{q:'Merger', a:'Fusi√≥n'} },
            { es:{q:'Adquisici√≥n', a:'Acquisition'}, en:{q:'Acquisition', a:'Adquisici√≥n'} },
            { es:{q:'Estatuto', a:'Statute'}, en:{q:'Statute', a:'Estatuto'} },
            { es:{q:'Reglamento', a:'Regulation'}, en:{q:'Regulation', a:'Reglamento'} },
            { es:{q:'Litigio', a:'Litigation'}, en:{q:'Litigation', a:'Litigio'} },
            { es:{q:'Arbitraje', a:'Arbitration'}, en:{q:'Arbitration', a:'Arbitraje'} },
            { es:{q:'Mediaci√≥n', a:'Mediation'}, en:{q:'Mediation', a:'Mediaci√≥n'} },
            { es:{q:'Declaraci√≥n', a:'Affidavit'}, en:{q:'Affidavit', a:'Declaraci√≥n jurada'} },
            { es:{q:'Citaci√≥n', a:'Subpoena'}, en:{q:'Subpoena', a:'Citaci√≥n'} },
            { es:{q:'Veredicto de culpabilidad', a:'Guilty verdict'}, en:{q:'Guilty verdict', a:'Culpable'} },
            { es:{q:'Absoluci√≥n', a:'Acquittal'}, en:{q:'Acquittal', a:'Absoluci√≥n'} },
            { es:{q:'Pena de muerte', a:'Death penalty'}, en:{q:'Death penalty', a:'Pena de muerte'} },
            { es:{q:'Homicidio', a:'Homicide'}, en:{q:'Homicide', a:'Homicidio'} },
            { es:{q:'Fraude', a:'Fraud'}, en:{q:'Fraud', a:'Fraude'} },
            { es:{q:'Soborno', a:'Bribery'}, en:{q:'Bribery', a:'Soborno'} }
        ];

        /* ================= LOGICA PRINCIPAL ================= */
        // Esperamos a que el DOM est√© listo para evitar errores de "null"
        document.addEventListener('DOMContentLoaded', function() {
            
            // 1. FIX DE SEGURIDAD HIGHCHARTS (Aseguramos que existe objeto)
            try {
                if (typeof Highcharts !== 'undefined' && Highcharts.AST) {
                    if (Highcharts.AST.allowedTags.indexOf('img') === -1) Highcharts.AST.allowedTags.push('img');
                    if (Highcharts.AST.allowedAttributes.indexOf('src') === -1) Highcharts.AST.allowedAttributes.push('src');
                    console.log("‚úÖ Highcharts Configurado");
                }
                if (typeof Highcharts !== 'undefined') {
                    Highcharts.setOptions({ accessibility: { enabled: false } });
                }
            } catch (e) { console.error("Error Highcharts Config:", e); }

            // 2. VARIABLES GLOBALES
            let currentLanguage = localStorage.getItem('preferredLanguage') || 'es';
            let currentTheme = localStorage.getItem('preferredTheme') || 'dark';
            let currentQuizIndex = 0;
            let mapChart = null;
            let animTimeouts = [];

            // 3. REFERENCIAS DOM (Ahora es seguro llamarlas)
            const themeToggleBtn = document.getElementById('theme-toggle');
            const themeIcon = themeToggleBtn ? themeToggleBtn.querySelector('i') : null;
            const quizTermEl = document.getElementById('andi-quiz-term-text');
            const quizAnswerEl = document.getElementById('andi-quiz-answer');
            const quizRevealBtn = document.getElementById('andi-btn-reveal');
            const quizNextBtn = document.getElementById('andi-btn-next');
            const mapToggle = document.getElementById('mapToggle');
            const mapContent = document.getElementById('mapContent');

            // 4. FUNCIONES
            function applyTheme(theme) {
                if (theme === 'light') {
                    document.body.classList.add('light-mode');
                    if(themeIcon) { themeIcon.classList.remove('fa-moon'); themeIcon.classList.add('fa-sun'); }
                } else {
                    document.body.classList.remove('light-mode');
                    if(themeIcon) { themeIcon.classList.remove('fa-sun'); themeIcon.classList.add('fa-moon'); }
                }
                // Si el mapa ya existe, actualizamos sus colores
                if(mapChart) {
                    setTimeout(() => {
                        const style = getComputedStyle(document.documentElement);
                        const newBorder = style.getPropertyValue('--map-border').trim();
                        const newNull = style.getPropertyValue('--map-null').trim();
                        
                        mapChart.update({
                            series: [{
                                borderColor: newBorder,
                                nullColor: newNull
                            }]
                        });
                    }, 50); // Peque√±o delay para asegurar que CSS cambi√≥
                }
            }

            function renderQuizCard() {
                const card = flashcards[currentQuizIndex];
                if (!card) return;
                const data = card[currentLanguage];
                if(quizTermEl) quizTermEl.textContent = data.q;
                if(quizAnswerEl) {
                    quizAnswerEl.textContent = data.a;
                    quizAnswerEl.classList.remove('visible');
                }
                if(quizRevealBtn) quizRevealBtn.textContent = translations[currentLanguage]['quiz-reveal'];
            }

            function setLanguage(lang) {
                document.body.classList.add('fading');
                setTimeout(() => {
                    currentLanguage = lang;
                    localStorage.setItem('preferredLanguage', lang);
                    document.documentElement.lang = lang;
                    
                    // Actualizar textos
                    Object.keys(translations[lang]).forEach(key => {
                        const element = document.getElementById(key);
                        if (element) {
                            if(key.includes('link')) element.setAttribute('title', translations[lang][key]);
                            else if(element.tagName === 'INPUT') element.placeholder = translations[lang]['label-jurisdiction'].replace(':', '');
                            else element.textContent = translations[lang][key];
                        }
                    });

                    // Placeholders especiales
                    const jurisdictionInput = document.getElementById('jurisdiction');
                    if(jurisdictionInput) {
                        jurisdictionInput.placeholder = lang === 'es' ? 'Ej: Madrid, Espa√±a' : 'E.g: Madrid, Spain';
                    }

                    // Botones idioma
                    document.querySelectorAll('.lang-btn').forEach(btn => {
                        btn.classList.toggle('active', btn.dataset.lang === lang);
                    });

                    // Texto bot√≥n mapa
                    const mapToggleText = document.getElementById('map-toggle-text');
                    if(mapContent && mapContent.classList.contains('expanded')) {
                        if(mapToggleText) mapToggleText.textContent = translations[lang]['map-hide'];
                    } else {
                        if(mapToggleText) mapToggleText.textContent = translations[lang]['map-show'];
                    }

                    renderQuizCard();
                    
                    // Actualizar mapa si existe
                    if(mapChart) {
                        mapChart.series[0].update({ name: currentLanguage === 'es' ? 'Viajes' : 'Travels' });
                        // Re-inicializamos para cargar nuevos textos de tooltips
                        initMap();
                    }

                    document.body.classList.remove('fading');
                }, 200);
            }

            function initMap() {
                if (typeof Highcharts === 'undefined') return;
                if (mapChart) mapChart.destroy();
                
                const repoBaseUrl = 'https://legemconnect.github.io/Contacto-Andrei/';
                const style = getComputedStyle(document.documentElement);
                const borderColor = style.getPropertyValue('--map-border').trim() || '#1e293b';
                const nullColor = style.getPropertyValue('--map-null').trim() || '#334155';

                mapChart = Highcharts.mapChart('map-container', {
                    chart: { map: 'custom/europe', backgroundColor: 'transparent', animation: false },
                    title: { text: '' },
                    mapNavigation: { enabled: false },
                    exporting: { enabled: false },
                    legend: { enabled: false },
                    credits: { enabled: false },
                    tooltip: { 
                        useHTML: true,
                        backgroundColor: 'rgba(255,255,255,0.95)',
                        borderRadius: 8,
                        borderWidth: 0,
                        shadow: true,
                        padding: 0,
                        headerFormat: '',
                        formatter: function () {
                            const point = this.point;
                            const images = point.customImgs || [];
                            const lang = currentLanguage;
                            const isWideClass = images.length > 1 ? 'wide' : '';
                            let imagesHtml = '';
                            
                            if (images.length > 0) {
                                imagesHtml = '<div class="tooltip-gallery">';
                                images.forEach(img => { 
                                    let finalSrc = img;
                                    if (!img.startsWith('http')) {
                                        finalSrc = repoBaseUrl + img;
                                    }
                                    imagesHtml += `<img src="${finalSrc}" alt="Foto viaje" style="display:block;">`; 
                                });
                                imagesHtml += '</div>';
                            }
                            
                            const name = point.customName[lang];
                            const text = point.customText[lang];
                            return `
                            <div class="custom-tooltip ${isWideClass}">
                                ${imagesHtml}
                                <h4 style="margin: 8px 0 5px 0; color:#2874A6; font-size:1.25em;">${name}</h4>
                                <p style="font-size:0.9em; margin:0; line-height:1.4;">${text || ''}</p>
                            </div>`;
                        }
                    },
                    series: [{
                        data: [],
                        name: currentLanguage === 'es' ? 'Viajes' : 'Travels',
                        joinBy: 'hc-key',
                        borderColor: borderColor, 
                        borderWidth: 1,
                        nullColor: nullColor, 
                        states: { hover: { color: getComputedStyle(document.documentElement).getPropertyValue('--map-hover').trim() || '#38bdf8' } }
                    }]
                });
            }

            function playMapAnimation() {
                animTimeouts.forEach(t => clearTimeout(t));
                animTimeouts = [];
                let currentData = [];
                const hoverColor = getComputedStyle(document.documentElement).getPropertyValue('--map-hover').trim() || '#38bdf8';
                
                visitedCountriesData.forEach((country, i) => {
                    const t = setTimeout(() => {
                        currentData.push({ 
                            'hc-key': country.code, 
                            value: 1, 
                            color: hoverColor, 
                            customName: country.name,
                            customText: country.text,
                            customImgs: country.imgs 
                        });
                        if(mapChart) {
                            mapChart.series[0].setData([...currentData], false);
                            mapChart.redraw(false);
                        }
                    }, i * 400); 
                    animTimeouts.push(t);
                });
            }

            // 5. EVENT LISTENERS
            if(themeToggleBtn) {
                themeToggleBtn.addEventListener('click', () => {
                    currentTheme = currentTheme === 'dark' ? 'light' : 'dark';
                    localStorage.setItem('preferredTheme', currentTheme);
                    applyTheme(currentTheme);
                });
            }

            document.querySelectorAll('.lang-btn').forEach(btn => btn.addEventListener('click', () => setLanguage(btn.dataset.lang)));

            if(quizRevealBtn) {
                quizRevealBtn.addEventListener('click', () => {
                    if(!quizAnswerEl) return;
                    const isVisible = quizAnswerEl.classList.contains('visible');
                    if (isVisible) {
                        quizAnswerEl.classList.remove('visible');
                        quizRevealBtn.textContent = translations[currentLanguage]['quiz-reveal'];
                    } else {
                        quizAnswerEl.classList.add('visible');
                        quizRevealBtn.textContent = translations[currentLanguage]['quiz-hide'];
                    }
                });
            }

            if(quizNextBtn) {
                quizNextBtn.addEventListener('click', () => {
                    currentQuizIndex = (currentQuizIndex + 1) % flashcards.length;
                    renderQuizCard();
                });
            }

            if(mapToggle) {
                mapToggle.addEventListener('click', function() {
                    mapContent.classList.toggle('expanded');
                    const icon = this.querySelector('i');
                    const mapToggleText = document.getElementById('map-toggle-text');
                    
                    if (mapContent.classList.contains('expanded')) {
                        if(mapToggleText) mapToggleText.textContent = translations[currentLanguage]['map-hide'];
                        if(icon) icon.style.transform = 'rotate(180deg)';
                        setTimeout(() => { initMap(); playMapAnimation(); }, 300);
                    } else {
                        if(mapToggleText) mapToggleText.textContent = translations[currentLanguage]['map-show'];
                        if(icon) icon.style.transform = 'rotate(0deg)';
                        animTimeouts.forEach(t => clearTimeout(t));
                    }
                });
            }
            
            // EmailJS init
            (function(){ emailjs.init('hz9CzCgK-LggHycqt'); })();
            
            const legalForm = document.getElementById('legal-form');
            if(legalForm) {
                legalForm.addEventListener('submit', function(event) {
                    event.preventDefault();
                    const btn = document.getElementById('btn-submit');
                    const originalText = btn.textContent;
                    btn.classList.add('loading');
                    btn.innerHTML = '<i class="fa-solid fa-circle-notch fa-spin"></i> Enviando...';
                    document.getElementById('confirmation').style.display = 'none';
                    document.getElementById('error').style.display = 'none';
                    
                    emailjs.sendForm('LegemConnect', 'template_m5tlbo5', this).then(function() {
                        document.getElementById('confirmation').style.display = 'block';
                        legalForm.reset();
                        btn.classList.remove('loading');
                        btn.innerHTML = originalText;
                        const lang = currentLanguage;
                        const responseDiv = document.getElementById('response');
                        responseDiv.innerHTML = `
                            <p><strong>${translations[lang]['response-thanks']}</strong></p>
                            <p>${translations[lang]['response-general']}</p>
                            <p>${translations[lang]['response-resources']}</p>
                            <ul style="text-align: left; margin-top: 5px;">
                                <li><a href='http://www.abogacia.es/servicios/' target='_blank' style="color:var(--accent-primary)">Abogac√≠a Espa√±ola</a></li>
                                <li><a href='https://justiciaoberta.gva.es/es/necessite-un-advocat-i-no-m-ho-puc-pagar/' target='_blank' style="color:var(--accent-primary)">Justicia Gratuita</a></li>
                            </ul>`;
                        responseDiv.style.display = 'block';
                    }, function(error) {
                        document.getElementById('error').style.display = 'block';
                        btn.classList.remove('loading');
                        btn.innerHTML = originalText;
                    });
                });
            }

            // 6. INICIALIZACI√ìN FINAL
            applyTheme(currentTheme);
            setLanguage(currentLanguage);
            renderQuizCard();
        });
    </script>
</body>
</html>
